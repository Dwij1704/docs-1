---
title: "XpanderClient"
description: "Core client for interacting with the Xpander API"
icon: "plug"
---

# XpanderClient

The `XpanderClient` is the primary entry point to the Xpander SDK. It handles authentication, API communication, and provides access to agent management.

## Initialization

Initialize the client with your API key:

<CodeBlock title="Initializing the XpanderClient">
```python
from xpander_sdk import XpanderClient
from dotenv import load_dotenv
import os

# Load API key from environment variables (recommended)
load_dotenv()
api_key = os.environ.get("XPANDER_API_KEY")

# Initialize the client
xpander_client = XpanderClient(api_key=api_key)
```
</CodeBlock>

### Parameters

| Parameter       | Type    | Required | Description                                       |
|-----------------|---------|----------|---------------------------------------------------|
| `api_key`       | str     | Yes      | Your Xpander API key                              |
| `base_url`      | str     | No       | Custom API base URL (for enterprise deployments)  |

## Working with Agents

The client provides methods for retrieving and creating agents through the `.agents` property.

### agents.get()

Retrieves an agent by ID.

<CodeBlock title="Retrieving an agent">
```python
# Get an agent by ID
agent = xpander_client.agents.get(agent_id="agent-1234-abcd")

# Access agent properties
print(f"Agent Name: {agent.name}")
print(f"Agent ID: {agent.id}")
print(f"Description: {agent.metadata.description}")
```
</CodeBlock>

#### Parameters

| Parameter  | Type  | Required | Description   |
|------------|-------|----------|---------------|
| `agent_id` | str   | Yes      | The agent ID  |

#### Returns

Returns an `Agent` object that provides methods for task execution, memory management, and tool usage.

### agents.list()

Retrieves a list of available agents.

<CodeBlock title="Listing agents">
```python
# Get list of available agents
agents = xpander_client.agents.list()

# Print information about each agent
for agent in agents:
    print(f"Agent: {agent.name} (ID: {agent.id})")
    print(f"- Description: {agent.metadata.description}")
    print(f"- Created: {agent.metadata.created_at}")
    print()
```
</CodeBlock>

#### Parameters

This method doesn't require any parameters.

#### Returns

Returns a list of `Agent` objects.

### agents.create()

Creates a new agent.

<CodeBlock title="Creating a new agent">
```python
# Define agent properties
agent_name = "Customer Support Agent"
agent_description = "An agent that helps with customer support inquiries."
agent_instructions = """
You are a helpful customer support agent for Acme Inc. 
When helping customers:
1. Always be polite and professional
2. Ask clarifying questions if needed
3. Provide accurate information about our products
4. Escalate complex issues to human support
"""

# Create the agent
new_agent = xpander_client.agents.create(
    name=agent_name,
    description=agent_description,
    instructions=agent_instructions
)

print(f"Created new agent with ID: {new_agent.id}")
```
</CodeBlock>

#### Parameters

| Parameter       | Type  | Required | Description                                 |
|-----------------|-------|----------|---------------------------------------------|
| `name`          | str   | Yes      | Agent name                                  |
| `description`   | str   | Yes      | Brief description of agent capabilities     |
| `instructions`  | str   | Yes      | Detailed instructions for the agent         |

#### Returns

Returns a newly created `Agent` object.

## Working with Operations

Xpander operations are pre-built tool definitions that can be attached to agents to provide specific capabilities.

### operations.list()

Lists available operations that can be attached to agents.

<CodeBlock title="Listing operations">
```python
# Get all available operations
operations = xpander_client.operations.list()

# Print information about each operation
for op in operations:
    print(f"Operation: {op.name}")
    print(f"- ID: {op.id}")
    print(f"- Description: {op.description}")
    print()
```
</CodeBlock>

#### Parameters

This method doesn't require any parameters.

#### Returns

Returns a list of Operation objects.

### operations.get()

Retrieves details about a specific operation by ID.

<CodeBlock title="Getting operation details">
```python
# Get details about a specific operation
operation = xpander_client.operations.get(operation_id="op-1234-abcd")

print(f"Operation: {operation.name}")
print(f"Description: {operation.description}")
print(f"Tools provided:")
for tool in operation.tools:
    print(f"- {tool.name}: {tool.description}")
```
</CodeBlock>

#### Parameters

| Parameter      | Type  | Required | Description      |
|----------------|-------|----------|------------------|
| `operation_id` | str   | Yes      | The operation ID |

#### Returns

Returns an Operation object with details about the operation and its tools.

## Static Utility Methods

The XpanderClient also provides several static utility methods for working with LLM responses and tool calls.

### extract_tool_calls()

Extracts tool calls from an LLM response, converting them to the Xpander format.

<CodeBlock title="Extracting tool calls">
```python
from xpander_sdk import LLMProvider
from openai import OpenAI

# Initialize OpenAI client
openai_client = OpenAI(api_key="your-openai-key")

# Get an LLM response with tool calls
response = openai_client.chat.completions.create(
    model="gpt-4o",
    messages=[{"role": "user", "content": "What's the weather in New York?"}],
    tools=[{
        "type": "function",
        "function": {
            "name": "get_weather",
            "description": "Get the current weather in a location",
            "parameters": {
                "type": "object",
                "properties": {
                    "location": {
                        "type": "string",
                        "description": "The city and state, e.g. San Francisco, CA"
                    }
                },
                "required": ["location"]
            }
        }
    }],
    tool_choice="auto"
)

# Extract tool calls from the response
tool_calls = XpanderClient.extract_tool_calls(
    llm_response=response.model_dump(),
    llm_provider=LLMProvider.OPEN_AI
)

# Print information about the extracted tool calls
for call in tool_calls:
    print(f"Tool: {call.name}")
    print(f"Type: {call.type}")
    print(f"Payload: {call.payload}")
    print(f"ID: {call.tool_call_id}")
```
</CodeBlock>

#### Parameters

| Parameter       | Type         | Required | Description                                       |
|-----------------|--------------|----------|---------------------------------------------------|
| `llm_response`  | Dict         | Yes      | The full response from the LLM                   |
| `llm_provider`  | LLMProvider  | No       | The LLM provider type (default: OPEN_AI)         |

#### Returns

Returns a list of `ToolCall` objects that can be executed by an agent.

### retrieve_pending_local_tool_calls()

Filters tool calls to identify those that should be executed locally.

<CodeBlock title="Getting local tool calls">
```python
# Extract all tool calls from the LLM response
all_tool_calls = XpanderClient.extract_tool_calls(
    llm_response=response.model_dump(),
    llm_provider=LLMProvider.OPEN_AI
)

# Filter for local tool calls only
local_tool_calls = XpanderClient.retrieve_pending_local_tool_calls(
    tool_calls=all_tool_calls
)

print(f"Found {len(local_tool_calls)} local tool calls")

# Print information about each local tool call
for call in local_tool_calls:
    print(f"Local tool: {call.name}")
    print(f"Payload: {call.payload}")
```
</CodeBlock>

#### Parameters

| Parameter     | Type           | Required | Description                                 |
|---------------|----------------|----------|---------------------------------------------|
| `tool_calls`  | List[ToolCall] | Yes      | List of tool calls to filter                |

#### Returns

Returns a filtered list of `ToolCall` objects of type `ToolCallType.LOCAL`.

## Handling Authentication

The `XpanderClient` automatically handles authentication and token refreshing behind the scenes. If your API key requires rotation, simply reinitialize the client with the new key.

<CodeBlock title="Updating API key">
```python
# Update the client with a new API key
xpander_client = XpanderClient(api_key=new_api_key)

# Continue using the client with the new authentication
agents = xpander_client.agents.list()
```
</CodeBlock>

## Error Handling

The SDK uses custom exceptions for different error scenarios.

<CodeBlock title="Error handling">
```python
from xpander_sdk import XpanderClient
from xpander_sdk.exceptions import AuthenticationError, ResourceNotFoundError, ApiError

try:
    # Initialize client
    xpander_client = XpanderClient(api_key="invalid-key")
    
    # Try to fetch an agent
    agent = xpander_client.agents.get(agent_id="agent-1234")
    
except AuthenticationError as e:
    print(f"Authentication failed: {e}")
    # Handle authentication error
    
except ResourceNotFoundError as e:
    print(f"Resource not found: {e}")
    # Handle missing resource
    
except ApiError as e:
    print(f"API error ({e.status_code}): {e}")
    # Handle other API errors
    
except Exception as e:
    print(f"Unexpected error: {e}")
    # Handle unexpected errors
```
</CodeBlock>

## Complete Example

This example demonstrates the full initialization process and basic operations with the `XpanderClient`:

<CodeBlock title="Complete client example">
```python
from xpander_sdk import XpanderClient, LLMProvider
from dotenv import load_dotenv
import os

# Load environment variables
load_dotenv()
XPANDER_API_KEY = os.environ.get("XPANDER_API_KEY")

# Initialize the client
xpander_client = XpanderClient(api_key=XPANDER_API_KEY)
print("Xpander client initialized successfully")

# List available agents
agents = xpander_client.agents.list()
print(f"Found {len(agents)} agents")

if agents:
    # Get the first agent
    agent = agents[0]
    print(f"Working with agent: {agent.name} (ID: {agent.id})")
    
    # List available operations
    operations = xpander_client.operations.list()
    print(f"Found {len(operations)} available operations")
    
    # Find a specific operation (e.g., web search)
    web_search_op = next((op for op in operations if "web" in op.name.lower()), None)
    
    if web_search_op:
        print(f"Found web search operation: {web_search_op.name}")
        
        # Attach the operation to the agent
        agent.attach_operations(operation_ids=[web_search_op.id])
        print(f"Attached {web_search_op.name} operation to {agent.name}")
        
        # Add a task to the agent
        agent.add_task(input="What are the latest developments in quantum computing?")
        print(f"Added task to agent")
        
        # The rest would be to initialize memory and run the execution loop
        print("Ready to run the agent with the new task")
else:
    # Create a new agent if none exists
    new_agent = xpander_client.agents.create(
        name="Research Assistant",
        description="An agent that helps with research tasks",
        instructions="You are a helpful research assistant. Provide accurate information and cite sources."
    )
    print(f"Created new agent: {new_agent.name} (ID: {new_agent.id})")
```
</CodeBlock>

## Related Resources

<CardGroup cols={2}>
  <Card title="Agent" icon="robot" href="/api-reference/07-sdk/agent">
    Learn about the Agent class
  </Card>
  <Card title="Operations" icon="gears" href="/api-reference/07-sdk/client/operations">
    Working with operations
  </Card>
  <Card title="Error Handling" icon="triangle-exclamation" href="/api-reference/07-sdk/client/errors">
    Understanding SDK errors
  </Card>
  <Card title="Authentication" icon="key" href="/api-reference/07-sdk/client/authentication">
    Authentication options
  </Card>
</CardGroup> 