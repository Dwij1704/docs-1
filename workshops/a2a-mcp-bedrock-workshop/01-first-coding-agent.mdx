---
title: "Module 1: Build Your First Coding Agent"
description: "Set up a local coding agent with MCP compliance and understand its core capabilities"
icon: "code"
---

In this module, you'll build your first autonomous coding agent using xpander.ai's framework. This agent will be able to understand and manipulate code, helping you automate development tasks.

## Setup Your Development Environment

Let's start by creating a workspace directory and cloning the base agent repository:

```bash
mkdir workshop 
cd workshop/
git clone https://github.com/xpander-ai/coding-agent.git
mv coding-agent dev-agent-1
```

Open the project in Cursor IDE:

```bash
cursor .
```

## Configure Your Local Environment

Inside the Cursor terminal, set up your Python environment and install dependencies:

```bash
python3 -m venv .venv && source .venv/bin/activate && pip install -r requirements.txt
```

Create a `.env` file in the root directory with the following credentials:

```
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_SESSION_TOKEN=your_aws_session_token  # if using temporary credentials
XPANDER_API_KEY=your_xpander_api_key
```

<Tip>
  Make sure you have your AWS credentials set up with Amazon Bedrock access and an xpander.ai API key ready for this step.
</Tip>

## Create Your Agent

Now let's use the xpander CLI to create a new agent:

```bash
xpander agent new
```

Complete the agent creation wizard:

```
✨ Create New Agent
────────────────────────────────────────────────────────────
? Enter a name for your new agent: dev-agent-1
⠋ Creating agent "dev-agent-1"...Creating agent in organization: 8d185373-8b24-47a7-8607-3e9036b968bb...
✔ Agent created successfully
? Would you like to personalize your agent now? No
⠋ Deploying agent...Deploying agent in organization: 8d185373-8b24-47a7-8607-3e9036b968bb...
⠋ Deploying agent...API Error (404): Unknown error
✔ Agent deployed successfully

✅ Agent created and ready to use!
? Would you like to locally initialize your agent now? Yes


✨ Initializing agent
────────────────────────────────────────────────────────────
ℹ Agent dev-agent-1 retrieved successfully
? The current directory is not empty. Proceeding will override 'requirements.txt' and add or update xpander-related files (xpander_config.json, agent_instructions.json, 
etc). Yes
✔ Agent initialized successfully
? Would you like to deploy your agent now? No
```

## Customize Agent Instructions

Now ask Cursor to help you create effective agent instructions:

```
Write instructions to my agent that is capable of the tools listed in local_tools.py and carefully validate the code before commiting it.
```

Copy the generated instructions into the `agent_instructions.json` file. Here's an example of what your instructions might look like:

```json
{
  "role": "Code Development and Validation Assistant",
  "goal": "Help users clone repositories, inspect code, make precise edits, create new files, and commit changes to Git with thorough validation to ensure code quality and correctness",
  "general": "You are a specialized development agent with access to Git operations and file management tools. Follow these guidelines when assisting users:\n\n1. Repository Management:\n   - Clone repositories when provided with valid URLs\n   - Inspect folder and file structures to understand codebases\n   - Help users navigate complex projects\n\n2. Code Reading and Writing:\n   - Read files to understand code context before making changes\n   - Make precise edits that maintain code style and conventions\n   - Create new files with proper formatting and structure\n\n3. Quality Assurance:\n   - Validate all code changes before committing\n   - Check for syntax errors, logical issues, and style inconsistencies\n   - Ensure imports and dependencies are properly handled\n   - Test code functionality when possible\n\n4. Version Control:\n   - Create meaningful commit messages that describe changes\n   - Use appropriate branch names following best practices\n   - Only commit when code has been thoroughly validated\n\n5. Communication:\n   - Explain your reasoning for code changes\n   - Provide clear documentation on what was modified\n   - Ask clarifying questions when user requirements are ambiguous\n\nAlways prioritize code quality and correctness over speed of implementation."
}
```

## Run Your Agent Locally

Now it's time to test your agent:

```bash
python main.py
```

<Note>
  Pay attention that the agent is limited to run inside the sandbox folder. To see files generated by the agent, navigate to the `sandboxes` folder and look for the thread ID from the terminal output.
</Note>

## Example Agent Interaction

Here's what you might see in the terminal as your agent runs:

```
Sandbox base directory: /Users/david/Developer/workshop/dev-agent-1/sandboxes
loading agent 8f5253fc-7a01-4a6b-b3c0-b5b3f0ae5aa9
/Users/david/Developer/workshop/dev-agent-1/agent_instructions.json
🧠 Adding task to a new thread
d8e0adaf-4555-4e0b-a310-053c8fbda1f9
🧠 Thread id: d8e0adaf-4555-4e0b-a310-053c8fbda1f9
🪄 Starting Agent Loop
--------------------------------------------------------------------------------
🔍 Step 1
running tool git_clone on agent 8f5253fc-7a01-4a6b-b3c0-b5b3f0ae5aa9 with execution 6a236df3-5ed4-489f-b25e-f1124a5d6f40
🔦 Executing local tool: git_clone with generated payload: {'repo_url': 'https://github.com/xpander-ai/coding-agent'}
✅ git_clone
```

The agent will proceed through several steps, analyzing the repository and performing actions based on its instructions.

After completing various tasks (like creating a markdown introduction file), you'll see the final agent response:

```
🧠 AI Agent response: I've created a comprehensive introduction to the Xpander Coding Agent framework. The document has been saved as `coding-agent-intro.md` in your workspace.

The introduction covers:

- My identity as an autonomous Coding Agent built with the xpander-ai/coding-agent framework
- The modular architecture featuring the core agent system, secure sandbox, and tool library
- Key capabilities including schema-driven actions, multi-step planning, and context-aware memory
- How the connector-based system integration works with Git, AWS Bedrock, filesystem, and thread isolation
- An explanation of the agent loop that enables reliable, auditable, and deterministic automation

This document provides a clear overview of how I function as a self-driven software engineer capable of generating, executing, and managing code through structured function-calling and intelligent agent loops.

Note: I attempted to commit the changes to a new branch named 'coding-agent-intro', but the commit operation wasn't successful. The file is still available in your local workspace.
```

You can now interact with your agent through the terminal by typing messages and questions!

## Stream Events from the Cloud

Now let's set up your agent to receive events from the xpander.ai cloud platform. This allows you to interact with your agent through the web UI while processing happens on your local machine.

### Modify the Event Handler

Edit the `xpander_handler.py` file to forward cloud events to your local agent:

```python
import json
from xpander_utils.events import XpanderEventListener, AgentExecutionResult, AgentExecution, ExecutionStatus
from xpander_sdk import XpanderClient
from coding_agent import CodingAgent

# === Load Configuration ===
# Reads API credentials and organization context from a local JSON file
with open('xpander_config.json', 'r') as config_file:
    xpander_config: dict = json.load(config_file)

# === Initialize Event Listener ===
# Create a listener to subscribe to execution requests from specified agent(s)
listener = XpanderEventListener(**xpander_config)

# initialize xpander_client
xpander = XpanderClient(api_key=xpander_config.get("api_key"))

# initialize agent instance
agent = xpander.agents.get(agent_id=xpander_config.get("agent_id"))
coding_agent = CodingAgent(agent=agent)
# === Define Execution Handler ===
def on_execution_request(execution_task: AgentExecution) -> AgentExecutionResult:
    """
    Callback triggered when an execution request is received from a registered agent.
    
    Args:
        execution_task (AgentExecution): Object containing execution metadata and input.

    Returns:
        AgentExecutionResult: Object describing the output of the execution.
    """
    # You can access the execution input via `execution_task.input`
    # Example: Extracting a specific input field
    # user_input = execution_task.input.get("user_prompt", "")
    
    agent.init_task(execution=execution_task.model_dump())    
    execution_status = coding_agent._agent_loop()
    return AgentExecutionResult(result=execution_status.result,is_success=True if execution_status.status == ExecutionStatus.COMPLETED else False)

# === Register Callback ===
# Attach your custom handler to the listener
listener.register(on_execution_request=on_execution_request)
```

### Run the Event Handler

Start the event handler to listen for cloud events:

```bash
python xpander_handler.py
```

You should see output similar to:

```
loading agent 8f5253fc-7a01-4a6b-b3c0-b5b3f0ae5aa9
https://app.xpander.ai/agents/8f5253fc-7a01-4a6b-b3c0-b5b3f0ae5aa9
```

### Access Your Agent in the Web UI

1. Navigate to the URL displayed in the terminal output (e.g., `https://app.xpander.ai/agents/8f5253fc-7a01-4a6b-b3c0-b5b3f0ae5aa9`)
2. You'll see your agent in the xpander.ai web interface
3. Try sending a message like "Hi" to your agent
4. Watch as the request is processed by your local machine and the response appears in the web UI

<Frame>![](/images/screenshots/2025-04-29-10-09-32.png)</Frame>

This setup creates a powerful hybrid system where your agent can be accessed through the cloud interface while all the processing happens securely on your local machine.

## Next Steps

Now that you've built your first coding agent, you're ready to expand your agent fleet in the [next module](/workshops/a2a-mcp-bedrock-workshop/02-expand-agent-fleet). 